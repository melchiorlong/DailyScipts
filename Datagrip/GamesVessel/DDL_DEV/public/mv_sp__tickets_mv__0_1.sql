create procedure public.mv_sp__tickets_mv__0_1(start_xid bigint, end_xid bigint, recompute_mv boolean, finished_xid_list character varying)
	language plpgsql
as $$
BEGIN IF Recompute_MV THEN EXECUTE $_7769898379041961234_$ CREATE TABLE "public"."mv_tbl__tickets_mv__0_recomputed" BACKUP YES DISTSTYLE KEY DISTKEY(2)  AS (SELECT "stat_kch_install_retention_count"."media_source" AS "media_source", CAST("stat_kch_install_retention_count"."oid" AS INT8) AS "stat_kch_install_retention_count_oid", CAST(1 AS INT4) AS "num_rec" FROM "public"."stat_kch_install_retention_count" AS "stat_kch_install_retention_count" WHERE ((CAST("stat_kch_install_retention_count"."insertxid" AS INT8) <= $_7769898379041961234_$ || end_xid || $_7769898379041961234_$) AND (CAST("stat_kch_install_retention_count"."deletexid" AS INT8) > $_7769898379041961234_$ || end_xid || $_7769898379041961234_$)) AND (("stat_kch_install_retention_count"."app_name" = CAST('dohko_ip' AS TEXT)) AND ("stat_kch_install_retention_count"."country" = CAST('JP' AS TEXT)))) $_7769898379041961234_$ ; CREATE OR REPLACE VIEW "public"."tickets_mv" AS (SELECT "derived_table1"."media_source" AS "media_source" FROM "public"."mv_tbl__tickets_mv__0_recomputed" AS "derived_table1"); DROP TABLE "public"."mv_tbl__tickets_mv__0"; ALTER TABLE "public"."mv_tbl__tickets_mv__0_recomputed" RENAME TO "mv_tbl__tickets_mv__0"; CREATE OR REPLACE VIEW "public"."tickets_mv" AS (SELECT "derived_table1"."media_source" AS "media_source" FROM "public"."mv_tbl__tickets_mv__0" AS "derived_table1"); ELSE  EXECUTE $_7769898379041961234_$ INSERT INTO "public"."mv_tbl__tickets_mv__0" (SELECT "stat_kch_install_retention_count"."media_source" AS "media_source", CAST("stat_kch_install_retention_count"."oid" AS INT8) AS "stat_kch_install_retention_count_oid", CAST(1 AS INT4) AS "num_rec" FROM "public"."stat_kch_install_retention_count" AS "stat_kch_install_retention_count" WHERE (((CAST("stat_kch_install_retention_count"."insertxid" AS INT8) > $_7769898379041961234_$ || start_xid || $_7769898379041961234_$) OR CAST("stat_kch_install_retention_count"."insertxid" AS INT8) IN $_7769898379041961234_$ || finished_xid_list || $_7769898379041961234_$) AND ((CAST("stat_kch_install_retention_count"."insertxid" AS INT8) <= $_7769898379041961234_$ || end_xid || $_7769898379041961234_$) AND (CAST("stat_kch_install_retention_count"."deletexid" AS INT8) > $_7769898379041961234_$ || end_xid || $_7769898379041961234_$))) AND (("stat_kch_install_retention_count"."app_name" = CAST('dohko_ip' AS TEXT)) AND ("stat_kch_install_retention_count"."country" = CAST('JP' AS TEXT)))) $_7769898379041961234_$; EXECUTE $_7769898379041961234_$ DELETE FROM "public"."mv_tbl__tickets_mv__0" USING (SELECT "stat_kch_install_retention_count"."media_source" AS "media_source", CAST("stat_kch_install_retention_count"."oid" AS INT8) AS "stat_kch_install_retention_count_oid", CAST(-1 AS INT4) AS "num_rec" FROM "public"."stat_kch_install_retention_count" AS "stat_kch_install_retention_count" WHERE ((CAST("stat_kch_install_retention_count"."insertxid" AS INT8) <= $_7769898379041961234_$ || start_xid || $_7769898379041961234_$) AND (NOT CAST("stat_kch_install_retention_count"."insertxid" AS INT8) IN $_7769898379041961234_$ || finished_xid_list || $_7769898379041961234_$ AND (((CAST("stat_kch_install_retention_count"."deletexid" AS INT8) > $_7769898379041961234_$ || start_xid || $_7769898379041961234_$) OR CAST("stat_kch_install_retention_count"."deletexid" AS INT8) IN $_7769898379041961234_$ || finished_xid_list || $_7769898379041961234_$) AND (CAST("stat_kch_install_retention_count"."deletexid" AS INT8) <= $_7769898379041961234_$ || end_xid || $_7769898379041961234_$)))) AND (("stat_kch_install_retention_count"."app_name" = CAST('dohko_ip' AS TEXT)) AND ("stat_kch_install_retention_count"."country" = CAST('JP' AS TEXT)))) AS "mv_tbl__tickets_mv__0__deletes" WHERE "mv_tbl__tickets_mv__0"."stat_kch_install_retention_count_oid" = "mv_tbl__tickets_mv__0__deletes"."stat_kch_install_retention_count_oid" $_7769898379041961234_$; END IF;  END;
$$;

